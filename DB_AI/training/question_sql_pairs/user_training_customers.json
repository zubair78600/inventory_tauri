[
    {
        "question": "customer today",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE date(i.created_at, '+5 hours', '30 minutes') = date('now', '+5 hours', '30 minutes') GROUP BY c.id ORDER BY \"TOTAL SPENT\" DESC"
    },
    {
        "question": "customer this month",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE strftime('%Y-%m', i.created_at) = strftime('%Y-%m', 'now', '+5 hours', '30 minutes') GROUP BY c.id ORDER BY \"TOTAL SPENT\" DESC"
    },
    {
        "question": "customers last month",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE strftime('%Y-%m', i.created_at) = strftime('%Y-%m', 'now', '+5 hours', '30 minutes', '-1 month') GROUP BY c.id ORDER BY \"TOTAL SPENT\" DESC"
    },
    {
        "question": "customers 2 months",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE i.created_at >= date('now', 'start of month', '-1 month', '+5 hours', '30 minutes') GROUP BY c.id ORDER BY \"TOTAL SPENT\" DESC"
    },
    {
        "question": "customers 2 complete months",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE i.created_at >= date('now', 'start of month', '-2 months', '+5 hours', '30 minutes') AND i.created_at < date('now', 'start of month', '+5 hours', '30 minutes') GROUP BY c.id ORDER BY \"TOTAL SPENT\" DESC"
    },
    {
        "question": "customers in last 2 weeks",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE i.created_at >= date('now', '+5 hours', '30 minutes', 'weekday 0', '-14 days') GROUP BY c.id ORDER BY \"TOTAL SPENT\" DESC"
    },
    {
        "question": "customers 2 complete weeks",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE i.created_at >= date('now', '+5 hours', '30 minutes', 'weekday 0', '-21 days') AND i.created_at < date('now', '+5 hours', '30 minutes', 'weekday 0', '-7 days') GROUP BY c.id ORDER BY \"TOTAL SPENT\" DESC"
    },
    {
        "question": "customer this week",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c JOIN invoices i ON c.id = i.customer_id WHERE i.created_at >= date('now', '+5 hours', '30 minutes', 'weekday 0', '-7 days') GROUP BY c.id ORDER BY \"TOTAL SPENT\" DESC"
    },
    {
        "question": "List all customers",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id GROUP BY c.id ORDER BY \"NAME\""
    },
    {
        "question": "customer supplier list",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id GROUP BY c.id ORDER BY \"NAME\""
    },
    {
        "question": "How many customers do we have?",
        "sql": "SELECT COUNT(*) as total_customers FROM customers"
    },
    {
        "question": "Show customers with credit balance",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", (COALESCE(SUM(i.total_amount), 0) - COALESCE((SELECT SUM(cp.amount) FROM customer_payments cp WHERE cp.customer_id = c.id), 0)) as \"CREDIT BALANCE\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id GROUP BY c.id HAVING \"CREDIT BALANCE\" > 0 ORDER BY \"CREDIT BALANCE\" DESC"
    },
    {
        "question": "Who are the top 10 customers by spending?",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c JOIN invoices i ON c.id = i.customer_id GROUP BY c.id ORDER BY \"TOTAL SPENT\" DESC LIMIT 10"
    },
    {
        "question": "Show customer purchase history",
        "sql": "SELECT c.name AS \"NAME\", i.invoice_number AS \"INVOICE #\", i.total_amount AS \"AMOUNT\", datetime(i.created_at, '+5 hours', '30 minutes') AS \"DATE\" FROM customers c JOIN invoices i ON c.id = i.customer_id ORDER BY c.name, i.created_at DESC"
    },
    {
        "question": "Find customers from a specific state",
        "sql": "SELECT name as \"NAME\", phone as \"CONTACT INFO\", email as \"EMAIL\", state as \"STATE\", district as \"DISTRICT\", town as \"TOWN\" FROM customers WHERE state = 'Maharashtra' ORDER BY name"
    },
    {
        "question": "Show recently added customers",
        "sql": "SELECT name as \"NAME\", phone as \"CONTACT INFO\", email as \"EMAIL\", datetime(created_at, '+5 hours', '30 minutes') as \"CREATED AT\" FROM customers ORDER BY created_at DESC LIMIT 10"
    },
    {
        "question": "What is the total credit owed by customers?",
        "sql": "SELECT SUM(credit) as \"TOTAL CREDIT OWED\" FROM (SELECT (COALESCE(SUM(i.total_amount), 0) - COALESCE((SELECT SUM(cp.amount) FROM customer_payments cp WHERE cp.customer_id = c.id), 0)) as credit FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id GROUP BY c.id HAVING credit > 0)"
    },
    {
        "question": "Show customers who haven't purchased recently",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", date(MAX(i.created_at), '+5 hours', '30 minutes') as \"LAST PURCHASE\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id GROUP BY c.id HAVING \"LAST PURCHASE\" < date('now', '-30 days', '+5 hours', '30 minutes') OR \"LAST PURCHASE\" IS NULL ORDER BY \"LAST PURCHASE\""
    },
    {
        "question": "Search for customer by phone number",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id WHERE c.phone LIKE '%9876543210%' GROUP BY c.id"
    },
    {
        "question": "Show customer payment history",
        "sql": "SELECT c.name AS \"NAME\", cp.amount AS \"PAID AMOUNT\", cp.payment_method AS \"METHOD\", datetime(cp.paid_at, '+5 hours', '30 minutes') AS \"DATE\", i.invoice_number AS \"INVOICE #\" FROM customer_payments cp JOIN customers c ON cp.customer_id = c.id JOIN invoices i ON cp.invoice_id = i.id ORDER BY cp.paid_at DESC"
    },
    {
        "question": "How many repeat customers do we have?",
        "sql": "SELECT COUNT(*) as \"REPEAT CUSTOMERS\" FROM (SELECT customer_id, COUNT(*) as purchase_count FROM invoices WHERE customer_id IS NOT NULL GROUP BY customer_id HAVING purchase_count > 1)"
    },
    {
        "question": "Customer name zubair details",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id WHERE c.name LIKE '%zubair%' GROUP BY c.id"
    },
    {
        "question": "Find customer zubair",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id WHERE c.name LIKE '%zubair%' GROUP BY c.id"
    },
    {
        "question": "Show details for customer X",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id WHERE c.name LIKE '%X%' GROUP BY c.id"
    },
    {
        "question": "Customer info for NAME",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\", (COALESCE(SUM(i.total_amount), 0) - COALESCE((SELECT SUM(amount) FROM customer_payments WHERE customer_id = c.id), 0)) as \"CURRENT CREDIT\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id WHERE c.name LIKE '%NAME%' GROUP BY c.id"
    },
    {
        "question": "Who is customer NAME?",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\", (COALESCE(SUM(i.total_amount), 0) - COALESCE((SELECT SUM(amount) FROM customer_payments WHERE customer_id = c.id), 0)) as \"CURRENT CREDIT\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id WHERE LOWER(c.name) LIKE LOWER('%NAME%') GROUP BY c.id"
    },
    {
        "question": "Customer details for NAME",
        "sql": "SELECT c.name AS \"NAME\", c.phone AS \"CONTACT INFO\", c.address AS \"ADDRESS\", c.email AS \"EMAIL\", date(MAX(i.created_at), '+5 hours', '30 minutes') AS \"INVOICE DATE\", datetime(MAX(i.created_at), '+5 hours', '30 minutes') AS \"LAST BILLED\", COALESCE((SELECT SUM(ii.quantity) FROM invoice_items ii JOIN invoices i2 ON ii.invoice_id = i2.id WHERE i2.customer_id = c.id), 0) AS \"PRODUCTS BOUGHT\", SUM(i.total_amount) AS \"TOTAL SPENT\", COUNT(i.id) AS \"TOTAL INVOICES\" FROM customers c LEFT JOIN invoices i ON c.id = i.customer_id WHERE LOWER(c.name) LIKE LOWER('%NAME%') GROUP BY c.id"
    }
]